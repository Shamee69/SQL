-- Давайте посмотрим на динамику выручки от покупателей, которые в среднем покупают самые дорогие товары.  В качестве целевой метрики будем использовать среднюю цену купленного товара (UnitPrice), данные посмотрим за март 2011 года.
-- Посчитайте среднюю цену товара клиента (UnitPrice) с группировкой по id покупателя, используя агрегирующую функцию Avg, затем выведите строки с покупками тех покупателей, у которых самая высокая средняя цена купленного товара в марте. Не забывайте отфильтровать строки по условию Description != 'Manual'. В качестве ответа впишите CustomerID покупателя с самой высокой средней ценой купленного товара.
SELECT
    CustomerID,
    avg(UnitPrice) as avg_Price
FROM default.retail

WHERE Description != 'Manual'

GROUP BY 
    toStartOfMonth(InvoiceDate) as Month,
    CustomerID
HAVING
    Month = '2011-03-01'
ORDER BY
    avg_Price DESC
limit 100
